<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kuis Kelas | Murid</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@400;500;700&display=swap');
        @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css');
        
        :root {
            --primary: #5dadec;
            --accent: #00f7ff;
            --light: #e6f7ff;
            --dark: #1a3a6a;
            --glass: rgba(255, 255, 255, 0.15);
            --neon-glow: 0 0 10px var(--accent);
            --error: #ff6b6b;
            --success: #2ecc71;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Zen Kaku Gothic New', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            background: linear-gradient(135deg, #0a1a2e, #1a3a6a);
            min-height: 100vh;
            color: var(--light);
            perspective: 1000px;
            touch-action: manipulation;
        }
        
        .navbar {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            padding: 12px 15px;
            display: flex;
            flex-direction: column;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .logo-icon {
            width: 36px;
            height: 36px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 
                0 0 15px var(--primary),
                inset 0 0 5px white;
        }
        
        .logo-text {
            font-weight: 500;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            font-size: 16px;
        }
        
        .nav-links {
            display: flex;
            overflow-x: auto;
            gap: 8px;
            padding-bottom: 5px;
            -webkit-overflow-scrolling: touch;
        }
        
        .nav-link {
            color: var(--light);
            text-decoration: none;
            font-size: 13px;
            padding: 8px 12px;
            border-radius: 20px;
            transition: all 0.3s;
            white-space: nowrap;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .nav-link.active {
            background: var(--primary);
            box-shadow: var(--neon-glow);
        }
        
        .container {
            margin-top: 100px;
            padding: 15px;
            padding-bottom: 80px;
        }
        
        .header-section {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            font-size: 20px;
            margin-bottom: 8px;
        }
        
        .quiz-list {
            display: grid;
            gap: 15px;
        }
        
        .quiz-card {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }
        
        .quiz-card:hover {
            border-color: var(--primary);
            box-shadow: 0 5px 15px rgba(93, 173, 236, 0.2);
        }
        
        .quiz-title {
            font-weight: 500;
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .quiz-meta {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 10px;
        }
        
        .quiz-status {
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .status-active {
            background: rgba(46, 204, 113, 0.2);
            color: var(--success);
        }
        
        .status-expired {
            background: rgba(255, 107, 107, 0.2);
            color: var(--error);
        }
        
        .quiz-desc {
            font-size: 13px;
            margin-bottom: 10px;
            opacity: 0.9;
        }
        
        .quiz-actions {
            display: flex;
            justify-content: flex-end;
            margin-top: 15px;
        }
        
        .btn {
            padding: 10px 15px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s;
            min-width: 80px;
            text-align: center;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: 0 2px 10px rgba(93, 173, 236, 0.3);
        }
        
        .btn-primary:hover {
            background: #4ca0d8;
            transform: translateY(-2px);
        }
        
        .btn-accent {
            background: var(--accent);
            color: var(--dark);
            box-shadow: 0 2px 10px rgba(0, 247, 255, 0.3);
        }
        
        /* Quiz Detail View */
        .quiz-detail-container {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .quiz-info {
            margin-bottom: 15px;
        }
        
        .quiz-deadline {
            color: var(--accent);
            font-size: 13px;
        }
        
        .question-container {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 3px solid var(--primary);
        }
        
        .question-text {
            font-weight: 500;
            margin-bottom: 10px;
        }
        
        .options-list {
            margin-left: 15px;
        }
        
        .option-item {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .essay-answer {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            margin-top: 10px;
            resize: vertical;
            min-height: 100px;
        }
        
        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .btn-danger {
            background: var(--error);
            color: white;
        }
        
        /* Result View */
        .result-container {
            text-align: center;
            padding: 20px;
            display: none;
        }
        
        .result-score {
            font-size: 24px;
            margin: 15px 0;
        }
        
        .score-high {
            color: var(--success);
        }
        
        .score-medium {
            color: var(--accent);
        }
        
        .score-low {
            color: var(--error);
        }
        
        .bg-elements {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .bg-element {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, var(--primary), transparent 70%);
            opacity: 0.1;
            filter: blur(30px);
        }
    </style>
</head>
<body>
    <!-- Background Elements -->
    <div class="bg-elements">
        <div class="bg-element" style="width: 300px; height: 300px; top: -50px; left: -50px;"></div>
        <div class="bg-element" style="width: 200px; height: 200px; bottom: -30px; right: -30px;"></div>
    </div>
    
    <!-- Navigation -->
    <nav class="navbar">
        <div class="logo">
            <div class="logo-icon">üë®‚Äçüéì</div>
            <span class="logo-text">KUIS KELAS 8D</span>
        </div>
        <div class="nav-links">
            <a href="dashboard.html" class="nav-link">DASHBOARD</a>
            <a href="kuis.html" class="nav-link active">KUIS</a>
            <a href="tugas.html" class="nav-link">TUGAS</a>
            <a href="jadwal.html" class="nav-link">JADWAL</a>
            <a href="notifikasi.html" class="nav-link">INFORMASI</a>
        </div>
    </nav>
    
    <!-- Main Content -->
    <div class="container">
        <section class="header-section">
            <h1>Daftar Kuis</h1>
            <p>Kuis yang diberikan oleh guru</p>
        </section>
        
        <div class="quiz-list" id="quizzes-container">
            <!-- Daftar kuis akan dimuat di sini -->
        </div>
        
        <!-- Quiz Detail View -->
        <div id="quiz-detail" style="display: none;">
            <div class="quiz-detail-container">
                <div class="quiz-info">
                    <h2 id="detail-quiz-title"></h2>
                    <div class="quiz-deadline" id="detail-quiz-deadline"></div>
                    <div class="quiz-desc" id="detail-quiz-desc"></div>
                </div>
                
                <div id="quiz-questions-container">
                    <!-- Pertanyaan akan dimuat di sini -->
                </div>
                
                <div class="form-actions">
                    <button class="btn btn-danger" id="back-to-quiz-list">
                        Kembali
                    </button>
                    <button class="btn btn-primary" id="submit-quiz">
                        Kirim Jawaban
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Result View -->
        <div id="result-view" class="result-container">
            <h2>Hasil Kuis</h2>
            <div class="result-score" id="result-score">
                Skor: <span id="score-value">0</span>%
            </div>
            <p id="result-message"></p>
            <button class="btn btn-primary" id="back-to-quizzes">
                Kembali ke Daftar Kuis
            </button>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Ukuran font dinamis
            const baseFontSize = window.innerWidth < 400 ? 14 : 16;
            document.documentElement.style.fontSize = baseFontSize + 'px';
            
            // DOM Elements
            const quizzesContainer = document.getElementById('quizzes-container');
            const quizDetailView = document.getElementById('quiz-detail');
            const questionsContainer = document.getElementById('quiz-questions-container');
            const resultView = document.getElementById('result-view');
            
            // Touch feedback untuk tombol
            const buttons = document.querySelectorAll('.btn, .nav-link');
            buttons.forEach(btn => {
                btn.addEventListener('touchstart', function() {
                    this.style.transform = 'scale(0.95)';
                });
                btn.addEventListener('touchend', function() {
                    this.style.transform = '';
                });
            });
            
            // Mencegah zoom
            document.addEventListener('gesturestart', function(e) {
                e.preventDefault();
            });

            // Ambil kuis dari localStorage
            function getQuizzesFromStorage() {
                const quizzes = JSON.parse(localStorage.getItem('teacher_quizzes')) || {};
                return Object.values(quizzes); // Konversi object ke array
            }

            // Render daftar kuis
            function renderQuizList() {
                const quizzes = getQuizzesFromStorage();
                const container = document.getElementById('quizzes-container');
                
                if (quizzes.length === 0) {
                    container.innerHTML = '<p>Tidak ada kuis tersedia saat ini</p>';
                    return;
                }
                
                container.innerHTML = quizzes.map(quiz => {
                    const now = new Date();
                    const deadline = new Date(quiz.deadline);
                    const isExpired = now > deadline;
                    
                    return `
                        <div class="quiz-card" data-id="${quiz.id}">
                            <div class="quiz-title">${quiz.title}</div>
                            <div class="quiz-meta">
                                <span>Batas: ${deadline.toLocaleString()}</span>
                                <span class="quiz-status ${isExpired ? 'status-expired' : 'status-active'}">
                                    ${isExpired ? 'SELESAI' : 'AKTIF'}
                                </span>
                            </div>
                            <div class="quiz-desc">${quiz.description || 'Tidak ada deskripsi'}</div>
                            <div class="quiz-actions">
                                <button class="btn btn-accent start-quiz" ${isExpired ? 'disabled' : ''}>
                                    <i class="fas fa-pencil-alt"></i> ${isExpired ? 'Waktu Habis' : 'Kerjakan Kuis'}
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
                
                // Tambahkan event listener untuk tombol mulai kuis
                document.querySelectorAll('.start-quiz').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const quizId = this.closest('.quiz-card').dataset.id;
                        showQuizDetail(quizId);
                    });
                });
            }

            // Tampilkan detail kuis
            function showQuizDetail(quizId) {
                const quizzes = getQuizzesFromStorage();
                const quiz = quizzes.find(q => q.id === quizId);
                
                if (!quiz) {
                    alert('Kuis tidak ditemukan!');
                    return;
                }
                
                // Tampilkan info kuis
                document.getElementById('detail-quiz-title').textContent = quiz.title;
                document.getElementById('detail-quiz-deadline').textContent = `Batas waktu: ${new Date(quiz.deadline).toLocaleString()}`;
                document.getElementById('detail-quiz-desc').textContent = quiz.description || 'Tidak ada deskripsi';
                
                // Render pertanyaan
                questionsContainer.innerHTML = '';
                quiz.questions.forEach((q, index) => {
                    const questionElement = document.createElement('div');
                    questionElement.className = 'question-container';
                    questionElement.dataset.questionId = q.id;
                    
                    if (q.type === 'multiple') {
                        questionElement.innerHTML = `
                            <div class="question-text">${index + 1}. ${q.question}</div>
                            <div class="options-list">
                                ${q.options.map((opt, i) => `
                                    <div class="option-item">
                                        <input type="radio" name="q${q.id}" id="q${q.id}o${i}" value="${i}">
                                        <label for="q${q.id}o${i}">${opt}</label>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                    } else {
                        questionElement.innerHTML = `
                            <div class="question-text">${index + 1}. ${q.question}</div>
                            <textarea class="essay-answer" placeholder="Tulis jawaban Anda di sini..." data-question="${q.id}"></textarea>
                        `;
                    }
                    
                    questionsContainer.appendChild(questionElement);
                });
                
                // Tampilkan halaman detail dan sembunyikan daftar
                document.getElementById('quizzes-container').style.display = 'none';
                document.getElementById('quiz-detail').style.display = 'block';
            }

            // Kembali ke daftar kuis
            document.getElementById('back-to-quiz-list').addEventListener('click', function() {
                document.getElementById('quizzes-container').style.display = 'grid';
                document.getElementById('quiz-detail').style.display = 'none';
            });

            // Submit kuis
            document.getElementById('submit-quiz').addEventListener('click', function() {
                const quizId = document.querySelector('.quiz-card[data-id]').dataset.id;
                const quizzes = getQuizzesFromStorage();
                const quiz = quizzes.find(q => q.id === quizId);
                
                if (!quiz) {
                    alert('Kuis tidak ditemukan!');
                    return;
                }
                
                let correct = 0;
                const details = [];
                
                // Periksa jawaban
                quiz.questions.forEach(q => {
                    let userAnswer, isCorrect = false;
                    
                    if (q.type === 'multiple') {
                        const selectedOption = document.querySelector(`input[name="q${q.id}"]:checked`);
                        userAnswer = selectedOption ? parseInt(selectedOption.value) : null;
                        
                        if (userAnswer !== null) {
                            isCorrect = userAnswer === q.correctAnswer;
                            details.push({
                                question: q.question,
                                answer: q.options[userAnswer],
                                correct: isCorrect
                            });
                            
                            if (isCorrect) correct++;
                        }
                    } else {
                        const answerElement = document.querySelector(`textarea[data-question="${q.id}"]`);
                        userAnswer = answerElement ? answerElement.value.trim() : '';
                        
                        if (q.correctAnswer) {
                            isCorrect = userAnswer.toLowerCase() === q.correctAnswer.toLowerCase();
                            if (isCorrect) correct++;
                        }
                        
                        details.push({
                            question: q.question,
                            answer: userAnswer,
                            correct: isCorrect
                        });
                    }
                });
                
                // Hitung skor
                const totalQuestions = quiz.qu
