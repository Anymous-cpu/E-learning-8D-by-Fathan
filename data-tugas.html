<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Data Tugas 8D | Guru</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Zen+Kaku+Gothic+New:wght@400;500;700&display=swap');
@import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css');
:root {
    --primary: #5dadec;
    --accent: #00f7ff;
    --light: #e6f7ff;
    --dark: #1a3a6a;
    --glass: rgba(255, 255, 255, 0.15);
    --error: #ff6b6b;
    --success: #2ecc71;
    --warning: #f39c12;
}
* {margin:0;padding:0;box-sizing:border-box;font-family:'Zen Kaku Gothic New',sans-serif;}
body {
    background: linear-gradient(135deg, #0a1a2e, #1a3a6a);
    min-height: 100vh;
    color: var(--light);
}
.navbar {
    background: var(--glass);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    padding: 12px 15px;
    position: fixed;
    width: 100%;
    top: 0;
    z-index: 100;
    display: flex;
    flex-direction: column;
}
.logo {display:flex;align-items:center;gap:10px;margin-bottom:10px;}
.logo-icon {
    width:36px;height:36px;background:var(--primary);
    border-radius:50%;display:flex;justify-content:center;align-items:center;
    box-shadow:0 0 15px var(--primary), inset 0 0 5px white;
}
.nav-links {display:flex;overflow-x:auto;gap:8px;padding-bottom:5px;}
.nav-link {
    color: var(--light);text-decoration:none;font-size:13px;
    padding:8px 12px;border-radius:20px;transition:all 0.3s;white-space:nowrap;
    background: rgba(255,255,255,0.05);
}
.nav-link.active {background: var(--primary);}
.container {margin-top:100px;padding:15px;}
.header-section {
    background: var(--glass);backdrop-filter: blur(12px);
    border-radius: 12px;padding: 15px;margin-bottom: 20px;
    border: 1px solid rgba(255,255,255,0.2);
}
h1 {font-size:20px;margin-bottom:8px;}
.task-list {display:grid;gap:15px;}
.task-card {
    background: var(--glass);backdrop-filter: blur(12px);
    border-radius: 12px;padding: 15px;
    border: 1px solid rgba(255,255,255,0.2);
}
.task-header {display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;}
.task-title {font-weight:500;font-size:16px;color:var(--accent);}
.task-deadline {font-size:12px;color:var(--warning);}
.task-desc {font-size:14px;margin-bottom:15px;opacity:0.9;}
.student-submissions {margin-top:15px;border-top:1px dashed rgba(255,255,255,0.2);padding-top:15px;}
.submission-header {font-weight:500;margin-bottom:10px;}
.submission-list {display:grid;gap:10px;}
.submission-item {
    background: rgba(0,0,0,0.1);
    border-radius: 8px;
    padding: 10px;
}
.submission-student {font-weight:500;}
.submission-time {font-size:12px;opacity:0.8;}
.no-submissions {text-align:center;padding:15px;opacity:0.7;font-size:14px;}
.status-badge {
    padding: 4px 8px;border-radius: 12px;
    font-size: 12px;font-weight: 500;
}
.status-submitted {background: rgba(46,204,113,0.2);color: var(--success);}
.status-late {background: rgba(255,107,107,0.2);color: var(--error);}
.no-tasks {text-align:center;padding:30px;opacity:0.7;}
</style>
</head>
<body>
<nav class="navbar">
    <div class="logo">
        <div class="logo-icon">üë©‚Äçüè´</div>
        <span class="logo-text">DATA TUGAS 8D</span>
    </div>
    <div class="nav-links">
        <a href="manajemen.html" class="nav-link">MANAJEMEN</a>
        <a href="create-kuis.html" class="nav-link">BUAT KUIS</a>
        <a href="create-tugas.html" class="nav-link">BUAT TUGAS</a>
        <a href="pengumuman.html" class="nav-link">PENGUMUMAN</a>
        <a href="data-tugas.html" class="nav-link active">DATA TUGAS</a>
        <a href="data-kuis.html" class="nav-link">DATA KUIS</a>
    </div>
</nav>

<div class="container">
    <section class="header-section">
        <h1>Data Tugas Kelas 8D</h1>
        <p>Lihat tugas yang telah diberikan dan pengumpulan siswa</p>
    </section>
    <div id="tasks-display"></div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tasksDisplay = document.getElementById('tasks-display');

    function autoDeleteOldTasks() {
        const tasks = JSON.parse(localStorage.getItem('teacher_tasks')) || [];
        const now = new Date().getTime();
        const seventyTwoHours = 72 * 60 * 60 * 1000;
        const updatedTasks = tasks.filter(task => {
            const taskTime = new Date(task.createdAt).getTime();
            return (now - taskTime) <= seventyTwoHours;
        });
        localStorage.setItem('teacher_tasks', JSON.stringify(updatedTasks));
    }

    function loadTasks() {
        autoDeleteOldTasks();
        const tasks = JSON.parse(localStorage.getItem('teacher_tasks')) || [];
        const submissions = JSON.parse(localStorage.getItem('task_submissions')) || {};
        tasksDisplay.innerHTML = '';

        if (tasks.length === 0) {
            tasksDisplay.innerHTML = `
                <div class="no-tasks">
                    <i class="fas fa-info-circle" style="font-size:24px;margin-bottom:10px;"></i>
                    <p>Tidak ada tugas yang ditemukan</p>
                </div>
            `;
            return;
        }

        tasks.forEach(task => {
            const deadline = new Date(task.deadline);
            const now = new Date();
            const isOverdue = now > deadline;
            const taskSubmissions = submissions[task.id] || [];

            const taskCard = document.createElement('div');
            taskCard.className = 'task-card';
            taskCard.innerHTML = `
                <div class="task-header">
                    <div class="task-title">${task.title}</div>
                    <div class="task-deadline">
                        Batas: ${deadline.toLocaleString()}
                        ${isOverdue ? '<span class="status-badge status-late">TERLAMBAT</span>' : ''}
                    </div>
                </div>
                <div class="task-desc">${task.description || 'Tidak ada deskripsi'}</div>
                <div class="student-submissions">
                    <div class="submission-header">Pengumpulan Siswa (${taskSubmissions.length})</div>
                    ${taskSubmissions.length > 0 ? `
                        <div class="submission-list">
                            ${taskSubmissions.map(sub => `
                                <div class="submission-item">
                                    <div class="submission-student">${sub.studentName}</div>
                                    <div class="submission-time">
                                        Dikumpulkan: ${new Date(sub.timestamp).toLocaleString()}
                                        ${new Date(sub.timestamp) > deadline ?
                                            '<span class="status-badge status-late">TERLAMBAT</span>' :
                                            '<span class="status-badge status-submitted">TEPAT WAKTU</span>'}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div class="no-submissions">
                            <i class="fas fa-info-circle"></i>
                            <p>Belum ada siswa yang mengumpulkan</p>
                        </div>
                    `}
                </div>
            `;
            tasksDisplay.appendChild(taskCard);
        });
    }

    loadTasks();
});
</script>
</body>
</html>
